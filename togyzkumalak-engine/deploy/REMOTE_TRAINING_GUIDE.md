# ๐ ะะพะปะฝะพะต ััะบะพะฒะพะดััะฒะพ ะฟะพ ัะดะฐะปัะฝะฝะพะผั ะพะฑััะตะฝะธั AlphaZero ะฝะฐ Vast.ai

## ะกะพะดะตัะถะฐะฝะธะต
1. [ะะฑะทะพั ะฐััะธัะตะบัััั](#ะพะฑะทะพั-ะฐััะธัะตะบัััั)
2. [ะะพะดะบะปััะตะฝะธะต ะบ ัะตัะฒะตัั](#ะฟะพะดะบะปััะตะฝะธะต-ะบ-ัะตัะฒะตัั)
3. [ะะฐัััะพะนะบะฐ ะธ ะพะฑะฝะพะฒะปะตะฝะธะต ะบะพะดะฐ](#ะฝะฐัััะพะนะบะฐ-ะธ-ะพะฑะฝะพะฒะปะตะฝะธะต-ะบะพะดะฐ)
4. [ะะฐะฟััะบ ะฑัะบะตะฝะด-ัะตัะฒะตัะฐ](#ะทะฐะฟััะบ-ะฑัะบะตะฝะด-ัะตัะฒะตัะฐ)
5. [ะะฐะฟััะบ ะผะพัะฝะพะณะพ ะพะฑััะตะฝะธั (16 GPU)](#ะทะฐะฟััะบ-ะผะพัะฝะพะณะพ-ะพะฑััะตะฝะธั-16-gpu)
6. [ะกะธััะตะผะฐ ัะธะณะฝะฐะปะธะทะฐัะธะธ (ะะฝัะธ-ะบัะฐั)](#ัะธััะตะผะฐ-ัะธะณะฝะฐะปะธะทะฐัะธะธ-ะฐะฝัะธ-ะบัะฐั)
7. [ะะพะฝะธัะพัะธะฝะณ ะธ ะดะธะฐะณะฝะพััะธะบะฐ](#ะผะพะฝะธัะพัะธะฝะณ-ะธ-ะดะธะฐะณะฝะพััะธะบะฐ)
8. [ะกะบะฐัะธะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ](#ัะบะฐัะธะฒะฐะฝะธะต-ัะตะทัะปััะฐัะพะฒ)

---

## ะะฑะทะพั ะฐััะธัะตะบัััั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโ              โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   ะะะะะะฌะะซะ ะะะะะฌะฎะขะะ   โ              โ      VAST.AI ะกะะะะะ             โ
โ   (Windows/Mac/Linux)   โ              โ   (Ubuntu + 16x RTX 3090)       โ
โ                         โ              โ                                 โ
โ   โโโโโโโโโโโโโโโโโโโ   โ   SSH Tunnel โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ   โ ะัะฐัะทะตั ั UI    โโโโโผโโโโโโโโโโโโโโโผโโโบโ FastAPI Backend (8000)  โ   โ
โ   โโโโโโโโโโโโโโโโโโโ   โ              โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                         โ              โ              โ                  โ
โ   โโโโโโโโโโโโโโโโโโโ   โ              โ              โผ                  โ
โ   โ Jupyter Notebookโโโโโผโโโโโโโโโโโโโโโผโโโบโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ   โ (ะกัะพัะพะถ + ะะฒัะบ) โ   โ              โ   โ AlphaZero (16 GPU)      โ   โ
โ   โโโโโโโโโโโโโโโโโโโ   โ              โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ              โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ะะพะดะบะปััะตะฝะธะต ะบ ัะตัะฒะตัั

### 1. ะะพะดะฝััะธะต SSH-ััะฝะฝะตะปั (ะะพะบะฐะปัะฝะพ)
ะะฑัะทะฐัะตะปัะฝะพ ะดะปั ัะฐะฑะพัั UI ะฟะพ ะฐะดัะตัั `http://localhost:8000`. ะัะฟะพะปะฝััั ะฒ PowerShell/Terminal ะฝะฐ ัะฒะพะตะผ ะะ:

```powershell
# ะะฐะผะตะฝะธ ะะะะข ะธ IP ะฝะฐ ะดะฐะฝะฝัะต ะธะท Vast.ai (ะบะฝะพะฟะบะฐ SSH)
ssh -p ะะะะข root@IP_ะะะะะก -L 8000:localhost:8000
```

---

## ะะฐัััะพะนะบะฐ ะธ ะพะฑะฝะพะฒะปะตะฝะธะต ะบะพะดะฐ

### ะะพะปะฝะฐั ะพัะธััะบะฐ ะธ ะพะฑะฝะพะฒะปะตะฝะธะต (ะฒ Jupyter ะฝะฐ ัะตัะฒะตัะต)
ะัะปะธ ััะพ-ัะพ ะฟะพัะปะพ ะฝะต ัะฐะบ ะธะปะธ ะฝัะถะฝะพ ะฟะพะดััะฝััั ะฝะพะฒัะน ะบะพะด ั GitHub:

```python
import subprocess
import os
import time

os.chdir('/workspace/togyzkumalak/togyzkumalak-engine')

print("๐ช ะฃะฑะธะฒะฐะตะผ ััะฐััะต ะฟัะพัะตััั...")
subprocess.run("pkill -9 -f 'python run.py'", shell=True)
time.sleep(2)

print("๐ฅ ะะฑะฝะพะฒะปัะตะผ ะบะพะด ั GitHub...")
subprocess.run(['git', 'checkout', '.'], capture_output=True)
subprocess.run(['git', 'clean', '-fd'], capture_output=True)
result = subprocess.run(['git', 'pull', 'origin', 'master'], capture_output=True, text=True)
print(result.stdout)

print("โ ะะพัะพะฒะพ ะบ ะทะฐะฟััะบั!")
```

---

## ะะฐะฟััะบ ะฑัะบะตะฝะด-ัะตัะฒะตัะฐ

### ะงะธัััะน ััะฐัั ะฑัะบะตะฝะดะฐ (ะฒ Jupyter ะฝะฐ ัะตัะฒะตัะต)
ะะฐะฟััะบะฐะตั ัะตัะฒะตั ะธ ะฟะธัะตั ะปะพะณะธ ะฒ ัะฐะนะปั.

```python
import subprocess
import sys
import os
import time

os.chdir('/workspace/togyzkumalak/togyzkumalak-engine')

# ะะฐะฟััะบ
print("๐ ะะฐะฟััะบะฐะตะผ ัะตัะฒะตั...")
process = subprocess.Popen(
    [sys.executable, 'run.py'],
    stdout=open('server.log', 'w'),
    stderr=open('server_error.log', 'w'),
    start_new_session=True
)
print(f"โ ะกะตัะฒะตั ะทะฐะฟััะตะฝ! PID: {process.pid}")

time.sleep(10) # ะะดะตะผ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ

# ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั
import requests
try:
    r = requests.get('http://localhost:8000/api/health', timeout=5)
    print(f"โ ะกะตัะฒะตั ะพัะฒะตัะฐะตั: {r.json()}")
except:
    print("โ ะัะธะฑะบะฐ: ะกะตัะฒะตั ะฝะต ะพัะฒะตัะฐะตั!")
```

---

## ะะฐะฟััะบ ะผะพัะฝะพะณะพ ะพะฑััะตะฝะธั (16 GPU)

### ะะพะฝัะธะณััะฐัะธั Ultra-Parallel
ะญัะพั ะบะพะฝัะธะณ ะทะฐะดะตะนััะฒัะตั ะฒัะต 16 ะฒะธะดะตะพะบะฐัั ะดะปั ะฟะฐัะฐะปะปะตะปัะฝัั ะธะณั ะธ ะพะฑััะตะฝะธั.

```python
import requests

power_config = {
    "numIters": 100,          # ะัะตะณะพ ะธัะตัะฐัะธะน
    "numEps": 256,            # ะะณั ะทะฐ ะธัะตัะฐัะธั (ะฟะพ 16 ะฝะฐ ะบะฐะถะดัั GPU)
    "numMCTSSims": 150,       # ะะปัะฑะธะฝะฐ ัะฐะทะดัะผะธะน (ัะผะฝะฐั ะผะพะดะตะปั)
    "cpuct": 1.5,             # ะะพัััะธัะธะตะฝั ะธััะปะตะดะพะฒะฐะฝะธั
    "hidden_size": 512,       # ะะฐะทะผะตั ะฝะตะนัะพัะตัะธ (ะผะพัะฝะฐั ะฐััะธัะตะบัััะฐ)
    "num_parallel_games": 16, # ะะะกะะะะะะะะะะ ะะ 16 GPU
    "use_bootstrap": True     # ะะฑััะตะฝะธะต ะฝะฐ ัะตะปะพะฒะตัะตัะบะธั ะดะฐะฝะฝัั ะฒ ะฝะฐัะฐะปะต
}

r = requests.post('http://localhost:8000/api/training/alphazero/start', json=power_config)
print(f"๐ฅ ะะะฉะะะ ะะะฃะงะะะะ ะะะะฃะฉะะะ: {r.json()}")
```

---

## ะกะธััะตะผะฐ ัะธะณะฝะฐะปะธะทะฐัะธะธ (ะะฝัะธ-ะบัะฐั)

### ะกะบัะธะฟั-ะกัะพัะพะถ ัะพ ะทะฒัะบะพะผ
ะะฐะฟัััะธ ััั ััะตะนะบั ะฒ Jupyter ะธ ะฝะต ะทะฐะบััะฒะฐะน ะฒะบะปะฐะดะบั. ะัะปะธ ะพะฑััะตะฝะธะต ัะฟะฐะดะตั โ ะพะฝ ะทะฐะฟะธัะธั.

```python
import requests
import time
from datetime import datetime
from IPython.display import display, Javascript

def play_alarm():
    display(Javascript("var c=new AudioContext();var o=c.createOscillator();o.type='sine';o.frequency.setValueAtTime(880,c.currentTime);o.connect(c.destination);o.start();setTimeout(function(){o.stop();},2000);"))

print("๐จ ะกะขะะะะ ะะะะฃะฉะะ. ะะต ะทะฐะบััะฒะฐะน ะฒะบะปะฐะดะบั!")

while True:
    try:
        r = requests.get('http://localhost:8000/api/training/alphazero/sessions', timeout=10)
        if r.json():
            s = r.json()[-1]
            status = s.get('status')
            now = datetime.now().strftime('%H:%M:%S')
            print(f"\rโ {now} | Iter: {s.get('iteration')} | ะะณั: {s.get('games_played')} | {status}...", end="")
            
            if status == 'failed':
                print("\nโ ะะะฃะงะะะะ ะฃะะะะ!")
                play_alarm()
                break
    except:
        print(f"\n๐ก ะะจะะะะ ะกะะฏะะ ะ {datetime.now()}!")
        play_alarm()
        break
    time.sleep(30)
```

---

## ะะพะฝะธัะพัะธะฝะณ ะธ ะดะธะฐะณะฝะพััะธะบะฐ

### 1. ะัะพะฒะตัะบะฐ ะทะฐะณััะทะบะธ ะฒัะตั 16 GPU
ะะพะบะฐะทัะฒะฐะตั, ัะบะพะปัะบะพ ะฟะฐะผััะธ ะทะฐะฝััะพ ะฝะฐ ะบะฐะถะดะพะน ะบะฐััะต ะธ ะธั ัะตะบัััั ะฝะฐะณััะทะบั.

```python
!nvidia-smi --query-gpu=index,utilization.gpu,memory.used,memory.total --format=csv,noheader,nounits
```

### 2. ะงัะตะฝะธะต ะปะพะณะพะฒ ะพัะธะฑะพะบ
ะัะปะธ ััะพ-ัะพ ะธะดะตั ะฝะต ัะฐะบ, ััะฐ ะบะพะผะฐะฝะดะฐ ะฟะพะบะฐะถะตั ะฟะพัะปะตะดะฝะธะต 20 ัััะพะบ ะพัะธะฑะพะบ:

```python
!tail -n 20 /workspace/togyzkumalak/togyzkumalak-engine/server_error.log
```

### 3. ะะพัะปะตะดะฝะธะต ัะพะฑััะธั ะพะฑััะตะฝะธั
```python
!grep -E "Iteration|Episode|Epoch|Bootstrap" /workspace/togyzkumalak/togyzkumalak-engine/server.log | tail -n 15
```

---

## ะกะบะฐัะธะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ

### ะกะบะฐัะฐัั ะปััััั ะผะพะดะตะปั (ะฝะฐ ะปะพะบะฐะปัะฝัะน ะะ)
ะัะฟะพะปะฝััั ะฒ PowerShell ะฝะฐ ัะฒะพะตะผ ะบะพะผะฟัััะตัะต:

```powershell
# ะะฐะผะตะฝะธ ะะะะข ะธ IP
scp -P ะะะะข root@IP_ะะะะะก:/workspace/togyzkumalak/togyzkumalak-engine/models/alphazero/best.pth.tar C:\Togyzkumalak_Results\
```

---
*ะะฑะฝะพะฒะปะตะฝะพ: ะะตะบะฐะฑัั 2024 (ะะฟัะธะผะธะทะธัะพะฒะฐะฝะพ ะฟะพะด 16x RTX 3090)*
